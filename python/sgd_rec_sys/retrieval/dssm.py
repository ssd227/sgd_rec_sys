"""
DSSM Deep Structured Semantic Models åŒå¡”æ¨¡å‹

åŸç†ï¼š
    * ç‰©å“å¡”ã€ç”¨æˆ·å¡”åˆ†åˆ«åšè¡¨å¾(ç‰¹å¾é¢„å¤„ç†ã€è¯­ä¹‰æå–)
    * åŒå¡”çš„è¾“å‡ºç”¨
    

åŒå¡”æ¨¡å‹çš„è®­ç»ƒ
â€¢ Pointwise:ç‹¬â½´çœ‹å¾…æ¯ä¸ªæ­£æ ·æœ¬ã€è´Ÿæ ·æœ¬ï¼Œåšç®€å•çš„â¼†å…ƒåˆ†ç±»ã€‚
    â€¢ æŠŠå¬å›çœ‹åšâ¼†å…ƒåˆ†ç±»ä»»åŠ¡ã€‚
    â€¢ å¯¹äºæ­£æ ·æœ¬,â¿åŠ±cos(a,b+) æ¥è¿‘+1ã€‚
    â€¢ å¯¹äºè´Ÿæ ·æœ¬,â¿åŠ±cos(a,b-)æ¥è¿‘-1ã€‚
    â€¢ æ§åˆ¶æ­£è´Ÿæ ·æœ¬æ•°é‡ä¸º1: 2æˆ–è€…1: 3ã€‚

â€¢ Pairwise:æ¯æ¬¡å–â¼€ä¸ªæ­£æ ·æœ¬ã€â¼€ä¸ªè´Ÿæ ·æœ¬[1]ã€‚
    åŸºæœ¬æƒ³æ³•:â¿åŠ±cos(a,b+)â¼¤äºcos(a,b-)
    Triplet hinge loss:
        â€¢ å¦‚æœcos(a, b+)â¼¤äºcos(a,b-)+ ğ‘šï¼Œåˆ™æ²¡æœ‰æŸå¤±ã€‚
        â€¢ å¦åˆ™,æŸå¤±ç­‰äºcos(a,b-) + ğ‘š - cos(a,b+) ã€‚

â€¢ Listwise:æ¯æ¬¡å–â¼€ä¸ªæ­£æ ·æœ¬ã€å¤šä¸ªè´Ÿæ ·æœ¬[2]ã€‚

"""

import torch
import torch.nn as nn

# æ³¨æ„
# ç‰¹å¾é¢„å¤„ç†ï¼ˆåªåŒºåˆ†ä¸ºä¸¤ç±»ï¼‰
    # dense feaï¼ˆç»„æˆä¸€ç»„å‘é‡ï¼Œç„¶åä½¿ç”¨ä½é˜¶çš„å…¨è¿æ¥å±‚ï¼‰
    # emb fea(ç±»åˆ«idå·)
    

class ItemNet():


class UserNet():


class SubNet(nn.Module):
    def __init__(self, ) -> None:
        super().__init__()
    
    

class DSSM(nn.Module):
    def __init__(self, ) -> None:
        super().__init__()
    
    

    def forward():
        # ç›®å‰åªå®ç°å•æœºå•å¡è®­ç»ƒ
    
    
    
    def 

